@startuml

class ToolManager
{
  -setup : SetupManager
  -creator : CreatorManager
  
  +RequestMoveToCreator(saveFile : CharacterSetupMemory) : void
  +RequestRealodTool() : void
}

ToolManager *-- SetupManager
ToolManager *-- CreatorManager
ToolManager *-l- Blackboard

class SetupManager
{
  -onStartRequested : UnityEvent<CharacterSetupMemory>
  
  +NewButtonPressed() : void
  +LoadButtonPressed() : void
}

class CreatorManager
{
  -head : ActiveBodyPart
  -torso : ActiveBodyPart
  -legs : ActiveBodyPart
  ..
  -partCompilation : Dictionary<Options, IActiveElement>
  ..
  -options : OptionFrontMan
  -pictureTaker : PictureTaker
  __
  +OnSwitchRequestReceived(type : Options, offset : int) : SwapCallbackResponse
  +OnSaveCommandReceived() : void
  +OnExportCommandReceived() : void
  +OnBackRequestReceived() : void
}

interface IActiveElement
{
  +type : Options
  +index : int
  ..
  +typeName : string
  +selectedName : string
  __
  +ProcessSwap(offset : int) : SwapCallbackResponse
  +ApplyIndex(index : int) : SwapCallbackResponse
}

interface IOptionInterface
{
  +Setup(compilation : Dictionary<Options, IActiveElement>) : void
  +SubscribeToBroadcast(request : SwapRequest) : void
  +UnsubscribeFromBroadcast(request : SwapRequest) : void
}

CreatorManager o--- IActiveElement
CreatorManager *--- IOptionInterface
CreatorManager *--- PictureTaker
CreatorManager ---> SaveBridge
CreatorManager -l-> Options
SaveBridge --> CharacterSetupMemory

class OptionFrontman extends IOptionInterface
{
  -options : List<OptionHandler>
  
  -HandleSwapRequest(type : Options, offset : int) : SwapCallbackResponse
}

class OptionHandler
{
  -type : Options
  -swapRequest : SwapRequest
  
  +PullNext() : void
  +PullPrevious() : void
  -SendAndProcessSwapRequest(offset : int) : void
}

OptionFrontman o-- OptionHandler

class OptionQueue <<ScriptableObject>>
{
  -type : Options
  -parts : GameObject[]
  
  +GetFromQueue(index : int) : GameObject
}

class ActiveBodyPart extends IActiveElement
{
  -queue : OptionQueue
  -modelObject : GameObject
  ..
  +ProcessSwap(index : int) : SwapCallbackResponse
  +ApplyIndex(index : int) : SwapCallbackResponse
}

ActiveBodyPart *-- OptionQueue
ActiveBodyPart --> SwapCallbackResponse

class PictureTaker
{
  -renderTexture : RenderTexture
  
  +TakePicture() : void
}

class Blackboard <<Singleton>>
{
  +loadedSave : CharacterSetupMemory
}

enum Options
{
  Head,
  Torso,
  Legs
}

class CharacterSetupMemory
{
  +savedIndices : Dictionary<Options, int>
}

class SwapCallbackResponse
{
  +result : Result
  +name : string
  +part : GameObject
}

class SaveBridge <<Static>>
{
  +SaveTo<T>(objectToSave : T, path : string) : void
  +SaveRawTo<T>(data : byte[], path : string) : void
  +LoadFrom<T>(path : string) : T
}

class RecentSaveTracker <<Static>>
{
    +RegisterRecentSave(location : string) : void
    +GetRegisteredSaves() : List<SaveRegistration>
}

SaveBridge --> RecentSaveTracker

@enduml